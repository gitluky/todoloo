<%= tag.div class: 'text-center' do %>
  <%= display_banner(@group) %><br />
  <%= tag.h2 @group.name, class: 'mt-3' %><br />
  <%= tag.p @group.description, class: 'mt-n3' %><br />
<% end %>

<%= tag.ul class: "mt-n4 nav nav-pills justify-content-center" do %>
  <%= link_to 'Post an Announcement', new_group_announcement_path(@group), class: 'nav-item nav-link' %>
  <%= link_to 'Send Invitation', new_group_invitation_path(@group), class: 'nav-item nav-link' %>
  <%= render partial: 'new_task_dropdown', locals: { group: @group, task: @task, members: @members, dropdown_name: 'Create Task', button_name: 'Create' } %>
  <% if current_user.is_admin?(@group) %>
    <%= link_to 'Edit', edit_group_path(@group), class: 'nav-item nav-link' %><br />
    <%= link_to 'Delete Group', group_path(@group), method: 'delete', class: 'nav-item nav-link', data: { confirm: 'Are you sure?' }%><br />
  <% end %>
<% end %>


<%= tag.div class: 'container-fluid' do %>
  <%= tag.div class: 'row text-center mt-4' do %>
    <%= tag.div class:'col-md-2' do %>
      <%= tag.div class: 'text-right' do %>
        <%= tag.p 'Admins:' %>
        <% @admins.each do |admin| %>
          <%= tag.li class: 'mt-2' do %>
            <% if current_user.is_admin?(@group) %>
              <%= tag.small do %>
                <%= link_to 'Remove Admin', group_delete_admin_path(@group, admin), class: 'mr-3', method: 'post' %>
              <% end %>
            <% end %>
            <%= admin.email %><%= display_avatar(admin, 'xs') %>
          <% end %>
        <% end %>
        <%= tag.p 'Members:', class: 'mt-4' %>
        <% @non_admins.each do |non_admin| %>
          <%= tag.li class: 'mt-2' do %>
            <% if current_user.is_admin?(@group) %>
              <%= tag.small do %>
                <%= link_to 'Make Admin', group_create_admin_path(@group, non_admin), class: 'mr-3', method: 'post' %>
              <% end %>
            <% end %>
            <%= non_admin.email %><%= display_avatar(non_admin, 'xs') %>
          <% end %>
        <% end %>


        <% if !@invitations.empty? %>
          Invitations:<br />
          <% @invitations.each do |invitation| %>
            Sent to: <%= invitation.recipient.email %><br />
            Sent by: <%= invitation.sender.email %><br />
          <% end %>
        <% end %>
      <% end %>
    <% end %>


    <%= tag.div class:'col-lg-3 text-left' do %>
        <% @announcements.each do |announcement| %>
        <%= tag.div class:'card mb-2' do %>
          <%= tag.div class:'card-header' do %>
            <%= tag.h5 announcement.created_at.strftime('%B, %d, %Y') %>
          <% end %>
          <%= tag.div class: 'card-body' do %>
            <%= tag.h5 announcement.title %>
            <%= announcement.content %>
          <% end %>
          <%= tag.div class: 'card-footer' do %>
            <%= tag.small class: 'text-muted' do %>
              <%= announcement.user.email if announcement.user %> @
              <%= announcement.updated_at.strftime('%B, %d, %Y') %>
            <% end %>
          <% end %>
        <% end %>
      <% end %>
    <% end %>

  <%= render partial: 'task_column', locals: { edit_path: edit_group_task_path(@group), group: @group, tasks: @available_tasks, members: @members, dropdown_name: 'Edit', button_name: 'Update', title: 'Available', div_class: 'col-lg-2' } %>
  <%= render partial: 'task_column', locals: { edit_path: edit_group_task_path(@group), group: @group, tasks: @assigned_tasks, members: @members, dropdown_name: 'Edit', button_name: 'Update', title: 'Assigned', div_class: 'col-lg-2' } %>
  <%= render partial: 'task_column', locals: { edit_path: edit_group_task_path(@group), group: @group, tasks: @completed_tasks, members: @members, dropdown_name: 'Edit', button_name: 'Update', title: 'Completed', div_class: 'col-lg-2' } %>

  <% end %>
<% end %>
